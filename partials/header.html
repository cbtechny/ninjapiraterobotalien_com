<div id="newsletter-container" style="background-color: #000; min-height: 0;"></div>

<style>
    /* Container is fixed at the top */
    #newsletter-container {
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        width: 100% !important;
        z-index: 2001 !important;
    }

    /* Force the moved bar to behave inside the container */
    #newsletter-container .formkit-sticky-bar {
        position: relative !important; /* relative to container */
        top: auto !important;
        bottom: auto !important;
        left: auto !important;
        right: auto !important;
        transform: none !important;
        width: 100% !important;
        margin: 0 !important;
        box-shadow: none !important;
        display: flex !important;
        justify-content: center;
    }

    /* Make the PLACEHOLDER sticky, not the header element itself.
       This works because the placeholder is a direct child of body (scroll container). */
    #header-placeholder {
        position: sticky !important;
        top: var(--header-offset, 0px) !important;
        z-index: 1000 !important;
        width: 100%;
    }

    /* Reset the header to fill the placeholder */
    header.site-header {
        position: static !important; /* Let placeholder handle sticking */
        top: auto !important;
        width: 100%;
    }

    /* Push body down so initial content isn't covered by fixed newsletter */
    body {
        padding-top: var(--header-offset, 0px);
        transition: padding-top 0.1s ease-out;
    }
</style>

<header class="site-header">
  <div class="container">
    <div class="header-content">
      <div class="logo">
        <a href="/index.html" class="logo-link">
          <span class="logo-text">N.P.R.A.</span>
          <span class="logo-accent">Games</span>
        </a>
      </div>
      <nav class="main-nav">
        <ul>
          <li><a href="/index.html" class="nav-home">Home</a></li>
          <li><a href="/sackjack-island/index.html">Sackjack Island</a></li>
          <li><a href="/devlogs/index.html">Devlogs</a></li>
          <li><a href="/studio/store.html">Store</a></li>
          <li><a href="/studio/about.html">About</a></li>
          <li><a href="/studio/contact.html">Contact</a></li>
        </ul>
      </nav>
      <button class="mobile-menu-toggle" aria-label="Toggle menu">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
  </div>
</header>

<!-- User Script -->
<script async data-uid="76bff091f1" src="https://npragames.kit.com/76bff091f1/index.js"></script>

<!-- Relocation & Layout Script -->
<script>
(function() {
    const container = document.getElementById('newsletter-container');

    // Function to update the header offset based on newsletter height
    function updateHeaderOffset() {
        if (container) {
            // If container is empty, height is 0. If bar is there, it has height.
            const height = container.offsetHeight;
            document.documentElement.style.setProperty('--header-offset', height + 'px');
        }
    }

    // ResizeObserver to handle dynamic height changes
    const resizeObserver = new ResizeObserver(() => {
        updateHeaderOffset();
    });

    if (container) {
        resizeObserver.observe(container);
    }

    function moveWidget() {
        const bar = document.querySelector('body > .formkit-sticky-bar');

        if (bar && container && !container.contains(bar)) {
            if (bar.tagName === 'BODY') return;

            container.appendChild(bar);

            // Allow CSS to apply and layout to calculate before updating offset
            setTimeout(updateHeaderOffset, 50);
        }
    }

    // Observer to watch for the widget being injected into body
    const observer = new MutationObserver((mutations) => {
        moveWidget();
    });

    observer.observe(document.body, { childList: true, subtree: false });

    // Fallback polling
    setInterval(moveWidget, 500);
})();
</script>
